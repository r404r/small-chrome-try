# small-chrome-try

> a chrome extension tools built with Vite + Vue, and Manifest v3

## Installing

1. Check if your `Node.js` version is >= **14**.
2. Change or configurate the name of your extension on `src/manifest`.
3. Run `npm install` to install the dependencies.

## Developing

run the command

```shell
$ cd small-chrome-try

$ pnpm run dev
```

### Chrome Extension Developer Mode

1. set your Chrome browser 'Developer mode' up
2. click 'Load unpacked', and select `small-chrome-try/build` folder

### Nomal FrontEnd Developer Mode

1. access `http://0.0.0.0:3000/`
2. when debugging popup page, open `http://0.0.0.0:3000//popup.html`
3. when debugging options page, open `http://0.0.0.0:3000//options.html`

## Packing

After the development of your extension run the command

```shell
$ pnpm run build
```

Now, the content of `build` folder will be the extension ready to be submitted to the Chrome Web Store. Just take a look at the [official guide](https://developer.chrome.com/webstore/publish) to more infos about publishing.

---

Generated by [create-chrome-ext](https://github.com/guocaoyi/create-chrome-ext)

---
I now have the content of all three configuration files. I can provide a comprehensive explanation for the user.

I will structure my explanation as follows:

1.  **`vite.config.ts`**:
    *   **Purpose**: The main configuration file for Vite, the build tool. It tells Vite how to build and serve your project.
    *   **Key Sections**:
        *   `import`: Shows the plugins being used (`@crxjs/vite-plugin` for Chrome extensions, `@vitejs/plugin-vue` for Vue).
        *   `server`: Configures the development server, including the port and HMR settings we added to fix the WebSocket issue.
        *   `build`: Defines how the production version is built (e.g., output directory is `build`, chunk file names).
        *   `plugins`: The heart of the configuration, where you enable and configure Vite plugins. `crx({ manifest })` is crucial for packaging the project as an extension.

2.  **`tsconfig.json` (The Main TS Config)**:
    *   **Purpose**: The primary TypeScript configuration for your **application code** (i.e., everything inside the `src` directory that runs in the browser). It tells the TypeScript compiler (`tsc`) and your editor how to check and compile your `.ts` and `.vue` files.
    *   **Key Sections**:
        *   `compilerOptions`: Contains all the rules.
            *   `target: "ESNext"`: Compile to the latest JavaScript version.
            *   `module: "ESNext"`: Use modern JavaScript modules.
            *   `strict: true`: Enables all strict type-checking options, which is a best practice.
            *   `lib: ["ESNext", "DOM"]`: Tells TypeScript that your code will run in an environment that has modern JavaScript features (`ESNext`) and browser features (`DOM`).
            *   `types: ["vite/client", "chrome"]`: Includes type definitions for Vite's client-side features and the Chrome Extension APIs.
        *   `include`: Specifies which files are part of this project. Here, it's everything inside `src`.
        *   `references`: This is important. It links this config file to `tsconfig.node.json`, creating a "composite project". This tells TypeScript that there are separate configurations for the app code and the build-script code.

3.  **`tsconfig.node.json` (The Node.js TS Config)**:
    *   **Purpose**: A **secondary**, more specialized TypeScript configuration used **only** for the files that run in a Node.js environment during the build process, **not** in the browser. In this project, that's primarily `vite.config.ts` itself.
    *   **Key Sections**:
        *   `compilerOptions`:
            *   `composite: true`: Marks this as part of a composite project, linking it back to `tsconfig.json`.
            *   `moduleResolution: "Node"`: Tells TypeScript to use the Node.js algorithm for finding modules, which is necessary for build scripts.
        *   `include`: Specifies which files this configuration applies to. As you can see, it only includes `vite.config.ts` and `src/manifest.ts` (because the manifest is imported by the vite config).

4.  **Summary of the Relationship**:
    *   You write your app code in `src`. `tsconfig.json` governs this code.
    *   You configure your build process in `vite.config.ts`. `tsconfig.node.json` governs this file.
    *   `vite.config.ts` reads your app code and uses the rules from `tsconfig.json` (implicitly) to build it into the final extension that runs in the browser.

This detailed explanation should be very helpful for a beginner. I will present this in a clear, structured way.
好的，我已经获取了全部三个文件的内容。下面我将为您详细解释它们各自的作用以及它们之间的关系。

---

### 1. `vite.config.ts` - 项目的“总工程师”

这个文件是 **Vite** 的核心配置文件。Vite 是一个现代化的前端构建工具，负责两件大事：
*   **开发时**：启动一个开发服务器，让您能实时预览代码改动（也就是您运行 `pnpm run dev` 时启动的东西）。
*   **构建时**：将您所有的 `.vue`, `.ts` 等源文件打包、压缩成浏览器可以直接运行的静态文件（HTML, CSS, JavaScript）。

在您的 `vite.config.ts` 文件中，关键内容包括：

*   **`plugins: [crx({ manifest }), vue()]`**: 这是最重要的部分，它告诉 Vite 要使用哪些“插件”来增强功能。
    *   `vue()`: 让 Vite 能够理解和处理 `.vue` 文件。
    *   `crx({ manifest })`: 这是将您的项目打包成一个**Chrome 扩展**的核心插件。它会自动处理 `manifest.json` 的生成、内容脚本的注入等复杂工作。
*   **`build: { ... }`**: 定义了当您运行 `pnpm run build` 时，Vite 应该如何操作。
    *   `outDir: 'build'`: 指定了打包后的文件应该放在一个名为 `build` 的文件夹里。
*   **`server: { ... }`**: 定义了开发服务器的行为。
    *   `port: 5173`: 我们之前为了修复 WebSocket 错误，明确指定了服务器必须在 `5173` 端口运行。

**一句话总结**：`vite.config.ts` 告诉 Vite “如何构建你的项目”。

---

### 2. `tsconfig.json` - “浏览器代码”的语法规则书

这个文件是 **TypeScript** 的主配置文件。它定义了一系列规则，告诉 TypeScript 编译器（以及您的 VS Code 编辑器）如何检查和理解您为**浏览器环境**编写的代码，也就是 `src` 文件夹下的所有 `.vue` 和 `.ts` 文件。

在您的 `tsconfig.json` 文件中，关键内容包括：

*   **`compilerOptions: { ... }`**: 这是编译器的选项，即具体的语法规则。
    *   `"target": "ESNext"`: 告诉编译器，您的目标是编译成最新版本的 JavaScript。
    *   `"lib": ["ESNext", "DOM"]`: 声明您的代码将运行在支持最新 JavaScript (`ESNext`) 和浏览器 API (`DOM`) 的环境中。这让您可以在代码中使用 `document`、`console` 等浏览器特有的全局变量而不会报错。
    *   `"types": ["vite/client", "chrome"]`: 明确告诉 TypeScript，这个项目需要加载 Vite 客户端和 Chrome 扩展的类型定义，这样您在写 `chrome.tabs.create(...)` 这样的代码时，就能获得智能提示和类型检查。
*   **`include: ["src/**/*.ts", ...]`**: 明确规定了这个配置文件**只负责**检查 `src` 文件夹下的所有相关文件。
*   **`references: [{ "path": "./tsconfig.node.json" }]`**: 这是一个“引用”声明，它告诉主配置文件：“嘿，还有一个专门给 Node.js 环境用的配置文件叫 `tsconfig.node.json`，我们俩是合作关系。”

**一句话总结**：`tsconfig.json` 定义了您 `src` 目录下所有**业务代码**的 TypeScript 规则。

---

### 3. `tsconfig.node.json` - “构建工具”的语法规则书

这是一个**辅助**的 TypeScript 配置文件。它的作用很专一：只负责检查那些在 **Node.js 环境**中运行的文件。在您的项目中，这主要就是指 `vite.config.ts` 文件本身。

为什么需要一个单独的配置文件呢？因为 `vite.config.ts` 运行在 Node.js 中，它能使用 `import fs from 'fs'` 这样的 Node.js API，但不能使用 `document.getElementById` 这样的浏览器 API。它的运行环境和您 `src` 目录下的代码完全不同。

在您的 `tsconfig.node.json` 文件中，关键内容包括：

*   **`compilerOptions: { ... }`**: 这里的规则是为 Node.js 环境量身定做的。
    *   `"moduleResolution": "Node"`: 告诉 TypeScript 使用 Node.js 的模块解析策略。
*   **`include: ["vite.config.ts", "src/manifest.ts"]`**: 明确规定了这个配置文件**只负责**检查 `vite.config.ts` 和被它引用的 `src/manifest.ts` 这两个文件。

**一句话总结**：`tsconfig.node.json` 定义了您**构建脚本**（`vite.config.ts`）的 TypeScript 规则。

---

### 它们如何协同工作？

您可以这样理解：

1.  您在 `src` 文件夹里写 Vue 组件，`tsconfig.json` 确保您的代码语法正确，并且能获得浏览器和 Chrome API 的智能提示。
2.  您在 `vite.config.ts` 里配置项目如何打包，`tsconfig.node.json` 确保这个配置文件本身是类型安全的。
3.  当您运行 `pnpm run dev` 或 `pnpm run build` 时，Node.js 会执行 `vite.config.ts`。Vite 启动后，会去读取 `src` 目录下的文件，并使用 `tsconfig.json` 的规则来理解和处理它们，最终生成能在浏览器里运行的扩展程序。

希望这个解释能帮助您更好地理解项目的结构！

---
我已为您详细解释了 `vite.config.ts`、`tsconfig.json` 和 `tsconfig.node.json` 这三个核心配置文件的作用和内容。

总结如下：
- **`vite.config.ts`**: 这是 **Vite 构建工具**的配置文件，如同项目的“总工程师”，负责定义项目的开发和打包流程，特别是通过插件（如 `crx` 和 `vue`）来处理 Chrome 扩展和 Vue 文件的 специфику。
- **`tsconfig.json`**: 这是 **TypeScript** 的主配置文件，如同“浏览器代码的语法规则书”，负责定义您在 `src` 目录下编写的、将在**浏览器中运行**的所有应用代码的类型检查规则。
- **`tsconfig.node.json`**: 这是一个辅助的 TypeScript 配置文件，如同“构建工具的语法规则书”，它只负责检查那些在 **Node.js 环境中运行**的文件，在本项目中主要就是 `vite.config.ts` 文件本身。

这三个文件通过明确的分工和引用关系（`references`）协同工作，确保了您在不同运行环境（浏览器 vs. Node.js）下的代码都能得到正确的类型检查和处理，是现代前端项目工程化的一个典型实践。
